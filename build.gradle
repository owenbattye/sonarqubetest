plugins {
  id "org.sonarqube" version "2.7"
}

Task compile = task compile(type:Exec) {
    workingDir '.'
    commandLine 'cmd','/c', 'msbuild.exe', 'ClassLibrary1.sln', '/t:restore,rebuild'
}

task run() {
    dependsOn 'compile'
    dependsOn 'sonarqube'
}

sonarqube {
    properties {
        property "sonar.sourceEncoding", "UTF-8"
        property "sonar.sources", "ClassLibrary1"
    }
    skipProject=false
}

project.tasks.sonarqube.dependsOn compile